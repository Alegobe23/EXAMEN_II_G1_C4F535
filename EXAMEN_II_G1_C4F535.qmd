---
title: "PP"
format: html
editor: visual
---

# Portada

Universidad de Costa Rica

Escuela de Matemática

Segundo examen parcial

Prof. Luis Juárez Potoy

Estudiante: Alexandra González Bermúdez

II Semestre

2025

# Desarrollo de incisos

## Librerías

```{r}
library(readxl)
library(dplyr)
library(ggplot2)
```

1.  Cargar base de datos usando Power Query de Excel.

```{r}
base.datos <- read_excel("moras.xlsx")
View(base.datos)
```

2.  Realizar un resumen de 5 números incluyendo el promedio, para las columnas numéricas de la base de datos.

```{r}
#Resumen de la columna del salario. 
summary(base.datos$SALARIO)

#Resumen de la columna de la edad. 
summary(base.datos$EDAD)

```

3.  Realice una columna donde se identifiquen valores atípicos haciendo uso
    del Z-Score, de tal manera que si el valor absoluto del Z-Score es mayor a 1,96 se
    considera un valor atípico. Esto para la columna de salario y edad.

```{r}
#Se agrega una columna con el Z Score de la columna del salario. 
base.datos$Z.Score.Salario <- round((base.datos$SALARIO - mean(base.datos$SALARIO, na.rm = TRUE)) / sd(base.datos$SALARIO, na.rm = TRUE), 2)

#Se agrega una columna con el Z Score de la columna de la edad.
base.datos$Z.Score.Edad <- round((base.datos$EDAD - mean(base.datos$EDAD, na.rm = TRUE)) / sd(base.datos$EDAD, na.rm = TRUE), 2)

#Se agrega una columna con la clasificación del Z Score de la columna del salario.
base.datos$Categoría.Salario <- ifelse(abs(base.datos$Z.Score.Salario) > 1.96, "ATÍPICO","NORMAL")

#Se agrega una columna con la clasificación del Z Score de la columna de la edad.
base.datos$Categoría.Edad <- ifelse(abs(base.datos$Z.Score.Edad) > 1.96, "ATÍPICO","NORMAL")

View(base.datos)

```

4.  Detecte el porcentaje de valores faltantes en cada una de las columnas.

```{r}
porcentaje.NA.columnas <- data.frame(
  Columna = names(base.datos),
  Porcentaje.NA = round((colSums(is.na(base.datos)) / nrow(base.datos)) * 100, 2)
)

View(porcentaje.NA.columnas)
```

5.  Imputar los valores faltantes haciendo uso de algún método.

```{r}
#Para imputar los valores en las columnas de edad y salario, se utiliza el promedio respectivo de cada columna. En el caso de la columna del tipo de aseguramiento, se emplea la moda. 

#Procedemos a imputar la columna del salario. 

base.datos$SALARIO[is.na(base.datos$SALARIO)] <- 657534

#Procedemos a imputar la columna de la edad. 
base.datos$EDAD[is.na(base.datos$EDAD)] <- 41.91

#Para ver qué elemento se repite más en la columna del tipo de aseguramiento. 
table(base.datos$TIPO_ASEGURAMIENTO)

#Procedemos a imputar la columna de la edad. 
base.datos$TIPO_ASEGURAMIENTO[is.na(base.datos$TIPO_ASEGURAMIENTO)] <- "ASALARIADO"

View(base.datos)

```
